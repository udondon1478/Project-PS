%%{init: {
  'theme': 'base',
  'themeVariables': {
    'fontSize': '20px',
    'fontFamily': 'Noto Sans JP, sans-serif',
    'lineColor': '#333333',
    'primaryColor': '#f0f0f0',
    'primaryTextColor': '#1a1a1a',
    'primaryBorderColor': '#333333'
  },
  'flowchart': {
    'nodeSpacing': 80,
    'rankSpacing': 120,
    'curve': 'basis',
    'padding': 40,
    'wrappingWidth': 200
  }
}}%%

flowchart TB

%% â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ & DNS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
BROWSER["ğŸŒ <b>ãƒ–ãƒ©ã‚¦ã‚¶</b>"]
STARDOMAIN["ğŸ”— <b>ã‚¹ã‚¿ãƒ¼ãƒ‰ãƒ¡ã‚¤ãƒ³</b><br/>(DNS)"]

%% â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Oracle Cloud Infrastructure â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
subgraph OCI["Oracle Cloud Infrastructure"]
    direction TB
    
    subgraph WEBSERVER["Webã‚µãƒ¼ãƒå±¤"]
        NGINX["ğŸ”’ <b>nginx</b><br/>ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·"]
        LETSENCRYPT["ğŸ” <b>Let's Encrypt</b><br/>SSL/TLS"]
    end
    
    subgraph APPSERVER["ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤"]
        PM2["âš¡ <b>PM2</b><br/>ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†"]
        
        subgraph NEXTJS["Next.js 16"]
            SC["<b>Server<br/>Components</b>"]
            CC["<b>Client<br/>Components</b>"]
            API["<b>API<br/>Routes</b>"]
        end
    end
    
    subgraph DATALAYER["ãƒ‡ãƒ¼ã‚¿å±¤"]
        PRISMA["ğŸ“¦ <b>Prisma</b>"]
        PG[("ğŸ—„ï¸ <b>PostgreSQL</b>")]
    end
end

%% â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
subgraph EXTERNAL["å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹"]
    AUTH["ğŸ”‘ <b>Auth.js</b><br/>OAuth 2.0"]
    SENTRY["ğŸ“Š <b>Sentry</b><br/>ã‚¨ãƒ©ãƒ¼ç›£è¦–"]
end

%% â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CI/CD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
subgraph CICD["CI/CD"]
    GHA["ğŸš€ <b>GitHub<br/>Actions</b>"]
    TEST["ğŸ§ª <b>Vitest<br/>Playwright</b>"]
end

%% â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ¥ç¶šç·š â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
BROWSER ==>|"HTTPS"| STARDOMAIN
STARDOMAIN ==>|"DNS"| NGINX
LETSENCRYPT -.->|"è¨¼æ˜æ›¸"| NGINX
NGINX ==>|"ãƒ—ãƒ­ã‚­ã‚·"| PM2
PM2 ==> NEXTJS
CC <--> API
SC --> PRISMA
API --> PRISMA
PRISMA <--> PG
API <--> AUTH
NEXTJS -.-> SENTRY
GHA ==> TEST
GHA ==>|"ãƒ‡ãƒ—ãƒ­ã‚¤"| PM2

%% â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚¹ã‚¿ã‚¤ãƒ«å®šç¾© â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
classDef clientStyle fill:#e3f2fd,stroke:#1565c0,stroke-width:3px,color:#0d47a1
classDef dnsStyle fill:#fff9c4,stroke:#f9a825,stroke-width:3px,color:#5d4037
classDef webserverStyle fill:#00897b,stroke:#004d40,stroke-width:3px,color:#ffffff
classDef appStyle fill:#7c4dff,stroke:#311b92,stroke-width:3px,color:#ffffff
classDef nextjsStyle fill:#0d47a1,stroke:#1a237e,stroke-width:3px,color:#ffffff
classDef dataStyle fill:#c8e6c9,stroke:#2e7d32,stroke-width:3px,color:#1b5e20
classDef externalStyle fill:#ffe0b2,stroke:#e65100,stroke-width:3px,color:#bf360c
classDef cicdStyle fill:#f3e5f5,stroke:#6a1b9a,stroke-width:3px,color:#4a148c

%% â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚¹ã‚¿ã‚¤ãƒ«é©ç”¨ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
class BROWSER clientStyle
class STARDOMAIN dnsStyle
class NGINX,LETSENCRYPT webserverStyle
class PM2 appStyle
class SC,CC,API nextjsStyle
class PRISMA,PG dataStyle
class AUTH,SENTRY externalStyle
class GHA,TEST cicdStyle
