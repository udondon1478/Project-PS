# ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«å®Ÿè£…ãƒ—ãƒ©ãƒ³

## ğŸ“‹ ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼

ç¾åœ¨ã®ã‚¿ã‚°ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã¯ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’å‚ç…§ã—ãªãŒã‚‰ã‚¿ã‚°ä»˜ã‘ã‚„ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°åˆ¤å®šãŒè¡Œãˆã¾ã›ã‚“ã€‚ã“ã®ãƒ—ãƒ©ãƒ³ã§ã¯ã€ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ç’°å¢ƒã§ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«æ–¹å¼ã‚’å°å…¥ã—ã€ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã¨ãƒ•ã‚©ãƒ¼ãƒ ã‚’åŒæ™‚ã«æ“ä½œå¯èƒ½ã«ã™ã‚‹ã“ã¨ã§ã€UXã‚’å¤§å¹…ã«å‘ä¸Šã•ã›ã¾ã™ã€‚

**ç›®æ¨™**: ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã¨ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã‚’é–²è¦§ã—ã¤ã¤ã€ã‚¿ã‚°å…¥åŠ›ã‚„ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­å®šã‚’åŒæ™‚ã«è¡Œãˆã‚‹ç’°å¢ƒã‚’æä¾›ã™ã‚‹

**ã‚¹ã‚³ãƒ¼ãƒ—**: ãƒ•ã‚§ãƒ¼ã‚º1ã¨ã—ã¦ `/register-item` ãƒšãƒ¼ã‚¸ã®ã¿å®Ÿè£…

---

## ğŸ¯ æ„æ€æ±ºå®šã‚µãƒãƒªãƒ¼ï¼ˆå…¨16é …ç›®ï¼‰

### UI/UXè¨­è¨ˆ

| é …ç›® | æ±ºå®š | ç†ç”± |
|------|------|------|
| **å†ã‚ªãƒ¼ãƒ—ãƒ³UI** | å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä»˜è¿‘ã®ãƒœã‚¿ãƒ³ã®ã¿ | ã‚·ãƒ³ãƒ—ãƒ«ã€æ—¢å­˜UIã‚’æ´»ç”¨ |
| **å®Œäº†æ™‚ã®æŒ™å‹•** | ãƒ‘ãƒãƒ«é–‹ã„ãŸã¾ã¾ç¶­æŒ | åˆ¤å®šçµæœã‚’ç¢ºèªã—ãªãŒã‚‰å…¥åŠ›å¯èƒ½ |
| **ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤** | ãªã— | ãƒ‘ãƒãƒ«ã¨ãƒ•ã‚©ãƒ¼ãƒ ã‚’åŒæ™‚æ“ä½œå¯èƒ½ |
| **ãƒ‘ãƒãƒ«å¤–ã‚¯ãƒªãƒƒã‚¯** | é–‰ã˜ãªã„ | èª¤ã‚¯ãƒªãƒƒã‚¯é˜²æ­¢ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æ„å›³ã‚’å°Šé‡ |
| **ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ç®¡ç†** | ãƒˆãƒ©ãƒƒãƒ—ãªã— | ãƒ‘ãƒãƒ«ã¨ãƒ•ã‚©ãƒ¼ãƒ é–“ã‚’è‡ªç”±ã«ç§»å‹•å¯èƒ½ |
| **åˆæœŸã‚¿ãƒ–åˆ¶å¾¡** | initialTabã‚’å‹•çš„è¨­å®š | ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«å¿œã˜ãŸè¡¨ç¤º |
| **ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ç¯„å›²** | ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ã®ã¿ | ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ»ã‚¿ãƒ–ã¯å¸¸ã«è¡¨ç¤º |

### ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–è¨­è¨ˆ

| é …ç›® | æ±ºå®š | è©³ç´° |
|------|------|------|
| **ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆ** | 1024px | ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—(1024pxä»¥ä¸Š)=ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«ã€ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ/ãƒ¢ãƒã‚¤ãƒ«(1023pxä»¥ä¸‹)=ã‚·ãƒ¼ãƒˆ |
| **ãƒ‘ãƒãƒ«å¹…** | `clamp(450px, 40vw, 600px)` | ç”»é¢ã‚µã‚¤ã‚ºã«å¿œã˜ãŸæœ€é©åŒ– |
| **ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³** | 250ms ease-in-out | ãƒãƒ©ãƒ³ã‚¹ã®è‰¯ã„é€Ÿåº¦ |

### ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–

| é …ç›® | æ±ºå®š | å®Ÿè£… |
|------|------|------|
| **åˆå›åˆ¤å®šç¯„å›²** | ãƒšãƒ¼ã‚¸ã”ã¨ã«å€‹åˆ¥ | ã‚­ãƒ¼: `guideline-visited-register` |
| **LocalStorageã‚¨ãƒ©ãƒ¼** | é–‹ã„ãŸçŠ¶æ…‹ï¼ˆåˆå›æ‰±ã„ï¼‰ | ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ‰ã§ã‚‚æ©Ÿèƒ½ç´¹ä»‹ |

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ»æŠ€è¡“

| é …ç›® | æ±ºå®š | è©³ç´° |
|------|------|------|
| **ãƒã‚¦ãƒ³ãƒˆã‚¿ã‚¤ãƒŸãƒ³ã‚°** | åˆå›=å³æ™‚ã€2å›ç›®ä»¥é™=é…å»¶ | æ¡ä»¶ä»˜ããƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° |
| **z-index** | 40 | ãƒ˜ãƒƒãƒ€ãƒ¼ã‚ˆã‚Šæ‰‹å‰ |
| **ã‚¨ãƒ©ãƒ¼è¡¨ç¤º** | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º | ãƒ‡ãƒãƒƒã‚°ã—ã‚„ã™ã„ |

---

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹æˆ

```text
GuidelineContainer (æ‹¡å¼µ)
â”œâ”€â”€ mode: 'modal' | 'sidepanel' ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è¿½åŠ 
â”œâ”€â”€ < 1024px â†’ GuidelineSheet (æ—¢å­˜ã€ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆãƒ»ãƒ¢ãƒã‚¤ãƒ«)
â””â”€â”€ â‰¥ 1024px (ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—)
    â”œâ”€â”€ mode='modal' â†’ GuidelineDialog (æ—¢å­˜)
    â””â”€â”€ mode='sidepanel' â†’ GuidelineSidePanel (æ–°è¦)
        â”œâ”€â”€ å›ºå®šãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆã‚¿ã‚¤ãƒˆãƒ« + é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ï¼‰
        â”œâ”€â”€ ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå›ºå®šï¼‰
        â”œâ”€â”€ ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆãƒˆã‚°ãƒ«ï¼ˆå›ºå®šï¼‰
        â””â”€â”€ ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢
            â”œâ”€â”€ RatingFlowchart (æ—¢å­˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†åˆ©ç”¨)
            â”œâ”€â”€ RatingFlowchartDiagram (æ—¢å­˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†åˆ©ç”¨)
            â””â”€â”€ TagCategoryVisualizer (æ—¢å­˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†åˆ©ç”¨)
```

### æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«

1. **`src/components/guidelines/GuidelineSidePanel.tsx`**
   - GuidelineDialogã‚’ãƒ™ãƒ¼ã‚¹ã«ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«ç”¨ã«æœ€é©åŒ–
   - æ—¢å­˜ã®ã‚¿ãƒ–ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å†åˆ©ç”¨
   - ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ãªã—ã€ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒˆãƒ©ãƒƒãƒ—ãªã—

2. **`src/hooks/useGuidelineFirstVisit.ts`** (ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯)
   - LocalStorageã§åˆå›è¨ªå•åˆ¤å®š
   - ãƒšãƒ¼ã‚¸ã”ã¨ã®ã‚­ãƒ¼ç®¡ç†: `guideline-visited-${page}`
   - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆlocalStorageç„¡åŠ¹æ™‚ã¯å¸¸ã«åˆå›æ‰±ã„ï¼‰

### ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«

1. **`src/components/guidelines/GuidelineContainer.tsx`**
   - `mode` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è¿½åŠ 
   - ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆå¤‰æ›´: 1024px
   - æ¡ä»¶åˆ†å²ã§GuidelineSidePanelã‚’å‘¼ã³å‡ºã—

2. **`src/app/register-item/page.tsx` ã¾ãŸã¯é–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
   - `mode="sidepanel"` ã‚’æŒ‡å®š
   - `useGuidelineFirstVisit('register')` ãƒ•ãƒƒã‚¯ã§åˆæœŸçŠ¶æ…‹åˆ¶å¾¡
   - åˆå›è¨ªå•æ™‚ã®ã¿ãƒ‘ãƒãƒ«é–‹ã„ãŸçŠ¶æ…‹ã§ãƒã‚¦ãƒ³ãƒˆ
   - 2å›ç›®ä»¥é™ã¯ã‚¯ãƒªãƒƒã‚¯æ™‚ã«é…å»¶ãƒã‚¦ãƒ³ãƒˆ

---

## ğŸ’» æŠ€è¡“ä»•æ§˜

### 1. ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«ä»•æ§˜

#### ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

```css
// CSSä»•æ§˜
.guideline-sidepanel {
  /* ä½ç½® */
  position: fixed;
  left: 0;
  top: 0;
  height: 100vh;
  width: clamp(450px, 40vw, 600px); /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¹… */

  /* é‡ã­é † */
  z-index: 40; /* ãƒ˜ãƒƒãƒ€ãƒ¼ã‚ˆã‚Šæ‰‹å‰ */

  /* ã‚¹ã‚¿ã‚¤ãƒ« */
  background: white;
  border-right: 1px solid hsl(var(--border));
  box-shadow: 2px 0 8px rgba(0, 0, 0, 0.1);

  /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
  transition: transform 250ms ease-in-out, opacity 250ms ease-in-out;
}

/* é–‰ã˜ãŸçŠ¶æ…‹ */
.guideline-sidepanel[data-state="closed"] {
  transform: translateX(-100%);
  opacity: 0;
  pointer-events: none; /* ã‚¯ãƒªãƒƒã‚¯é˜²æ­¢ */
}

/* é–‹ã„ãŸçŠ¶æ…‹ */
.guideline-sidepanel[data-state="open"] {
  transform: translateX(0);
  opacity: 1;
}
```

#### å†…éƒ¨æ§‹é€ ï¼ˆã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«åˆ¶å¾¡ï¼‰

```tsx
<aside className="fixed left-0 top-0 h-screen w-[clamp(450px,40vw,600px)] flex flex-col">
  {/* å›ºå®šãƒ˜ãƒƒãƒ€ãƒ¼ */}
  <div className="shrink-0 px-6 py-4 border-b">
    <h2>ã‚¿ã‚°ä»˜ã‘ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³</h2>
    <Button onClick={onClose}><X /></Button>
  </div>

  {/* ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå›ºå®šï¼‰ */}
  <TabsList className="shrink-0 px-6 pt-4">
    <TabsTrigger value="rating">ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</TabsTrigger>
    <TabsTrigger value="categories">ã‚¿ã‚°ã‚«ãƒ†ã‚´ãƒª</TabsTrigger>
  </TabsList>

  {/* ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆï¼ˆå›ºå®šï¼‰ */}
  <div className="shrink-0 px-6 py-2 flex gap-2">
    <Toggle>ã‚¹ãƒ†ãƒƒãƒ—å½¢å¼</Toggle>
    <Toggle>å›³è¡¨ã§è¦‹ã‚‹</Toggle>
  </div>

  {/* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ */}
  <div className="flex-1 overflow-y-auto px-6 pb-4 min-h-0">
    {flowchartMode === 'interactive' ? (
      <RatingFlowchart onClose={onClose} />
    ) : (
      <RatingFlowchartDiagram />
    )}
  </div>
</aside>
```

#### ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆ

```typescript
// 1024pxä»¥ä¸Šã§ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«ã€æœªæº€ã§ã‚·ãƒ¼ãƒˆ
const isDesktop = useMediaQuery('(min-width: 1024px)');

// GuidelineContainer.tsx
if (!isDesktop) {
  return <GuidelineSheet {...props} />;
}

return mode === 'sidepanel'
  ? <GuidelineSidePanel {...props} />
  : <GuidelineDialog {...props} />;
```

### 2. åˆå›è¨ªå•åˆ¤å®š

#### LocalStorageå®Ÿè£…

```typescript
// hooks/useGuidelineFirstVisit.ts
export function useGuidelineFirstVisit(page: string) {
  const [isFirstVisit, setIsFirstVisit] = useState(() => {
    if (typeof window === 'undefined') return false;

    try {
      const key = `guideline-visited-${page}`;
      return !localStorage.getItem(key);
    } catch (error) {
      // LocalStorageç„¡åŠ¹æ™‚ã¯å¸¸ã«åˆå›æ‰±ã„ï¼ˆé–‹ã„ãŸçŠ¶æ…‹ï¼‰
      console.warn('localStorage unavailable:', error);
      return true;
    }
  });

  useEffect(() => {
    if (isFirstVisit && typeof window !== 'undefined') {
      try {
        const key = `guideline-visited-${page}`;
        localStorage.setItem(key, 'true');
      } catch (error) {
        // ã‚¨ãƒ©ãƒ¼ã¯ç„¡è¦–ï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ‰ç­‰ï¼‰
        console.warn('Failed to save visit state:', error);
      }
    }
  }, [isFirstVisit, page]);

  return isFirstVisit;
}
```

#### ä½¿ç”¨ä¾‹ï¼ˆæ¡ä»¶ä»˜ããƒã‚¦ãƒ³ãƒˆï¼‰

```typescript
// /app/register-item/page.tsx
const isFirstVisit = useGuidelineFirstVisit('register');
const [guidelineOpen, setGuidelineOpen] = useState(isFirstVisit);
const [shouldMount, setShouldMount] = useState(isFirstVisit);

// ãƒ‘ãƒãƒ«ã‚’é–‹ãæ™‚ã«ãƒã‚¦ãƒ³ãƒˆ
const handleOpenGuideline = (tab: 'rating' | 'categories') => {
  setShouldMount(true);
  setGuidelineOpen(true);
  setInitialTab(tab);
};

return (
  <>
    {/* ãƒ•ã‚©ãƒ¼ãƒ ã‚¨ãƒªã‚¢ */}
    <div>
      <RatingField>
        <Button onClick={() => handleOpenGuideline('rating')}>
          ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³
        </Button>
      </RatingField>

      <TagInput>
        <Button onClick={() => handleOpenGuideline('categories')}>
          ã‚¿ã‚°ã‚«ãƒ†ã‚´ãƒª
        </Button>
      </TagInput>
    </div>

    {/* ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ« - æ¡ä»¶ä»˜ããƒã‚¦ãƒ³ãƒˆ */}
    {shouldMount && (
      <GuidelineContainer
        mode="sidepanel"
        open={guidelineOpen}
        onOpenChange={setGuidelineOpen}
        initialTab={initialTab}
      />
    )}
  </>
);
```

### 3. ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œ

```typescript
// Escã‚­ãƒ¼ã§é–‰ã˜ã‚‹ï¼ˆãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒˆãƒ©ãƒƒãƒ—ãªã—ï¼‰
useEffect(() => {
  const handleKeyDown = (e: KeyboardEvent) => {
    if (e.key === 'Escape' && open) {
      onOpenChange(false);
    }
  };

  document.addEventListener('keydown', handleKeyDown);
  return () => document.removeEventListener('keydown', handleKeyDown);
}, [open, onOpenChange]);
```

### 4. ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£

```tsx
<aside
  role="complementary"
  aria-label="ã‚¿ã‚°ä»˜ã‘ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³"
  aria-hidden={!open}
  // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒˆãƒ©ãƒƒãƒ—ãªã— - ãƒ‘ãƒãƒ«ã¨ãƒ•ã‚©ãƒ¼ãƒ é–“ã‚’è‡ªç”±ã«ç§»å‹•å¯èƒ½
>
  <button
    aria-label="ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’é–‰ã˜ã‚‹"
    onClick={() => onOpenChange(false)}
  >
    <X className="h-4 w-4" />
  </button>

  {/* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */}
</aside>
```

### 5. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```tsx
// GuidelineSidePanel.tsx
const [error, setError] = useState<Error | null>(null);

try {
  // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„èª­ã¿è¾¼ã¿
} catch (err) {
  setError(err as Error);
}

if (error) {
  return (
    <div className="p-6 text-destructive">
      <p className="font-semibold">ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</p>
      <p className="text-sm mt-2">{error.message}</p>
      <Button onClick={() => window.location.reload()} className="mt-4">
        å†èª­ã¿è¾¼ã¿
      </Button>
    </div>
  );
}
```

---

## ğŸ“± ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–è¨­è¨ˆ

### ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ— (1024pxä»¥ä¸Š)

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Header                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              â”‚  å•†å“ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ          â”‚
â”‚  ã‚µã‚¤ãƒ‰      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  ãƒ‘ãƒãƒ«      â”‚  â”‚ å•†å“ç”»åƒ           â”‚ â”‚
â”‚  (450-600px) â”‚  â”‚ (æ®‹ã‚Šé ˜åŸŸ)         â”‚ â”‚
â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³â”‚ â”‚  â”‚ ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°       â”‚ â”‚
â”‚ â”‚ã‚°        â”‚ â”‚  â”‚ [é¸æŠãƒœãƒƒã‚¯ã‚¹]     â”‚ â”‚
â”‚ â”‚         â”‚ â”‚  â”‚ [ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³è¡¨ç¤º] â”‚ â”‚
â”‚ â”‚ãƒ•ãƒ­ãƒ¼   â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚ãƒãƒ£ãƒ¼ãƒˆ â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚         â”‚ â”‚  â”‚ ã‚¿ã‚°å…¥åŠ›           â”‚ â”‚
â”‚ â”‚(ã‚¹ã‚¯ãƒ­ãƒ¼â”‚ â”‚  â”‚ [å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰]   â”‚ â”‚
â”‚ â”‚ãƒ«)      â”‚ â”‚  â”‚ [ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³è¡¨ç¤º] â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç‰¹å¾´:**
- å·¦å´: ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«ï¼ˆ450-600pxã€ç”»é¢å¹…40%ã‚’åŸºæº–ï¼‰
- å³å´: ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆæ®‹ã‚Šå…¨é ˜åŸŸï¼‰
- å·¦å´ã®å•†å“ã‚¿ã‚¤ãƒˆãƒ«ãƒ»èª¬æ˜ã¯ãƒ‘ãƒãƒ«ã«éš ã‚Œã‚‹ï¼ˆè‡ªå‹•å–å¾—ã®ãŸã‚å•é¡Œãªã—ï¼‰
- ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ãªã—ã€åŒæ™‚æ“ä½œå¯èƒ½

### ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ (768px - 1023px)

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Header              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å•†å“ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ     â”‚
â”‚                     â”‚
â”‚ [ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°]      â”‚
â”‚ [ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³è¡¨ç¤º]  â”‚ â† ã‚¿ãƒƒãƒ—ã§ã‚·ãƒ¼ãƒˆè¡¨ç¤º
â”‚                     â”‚
â”‚ [ã‚¿ã‚°å…¥åŠ›]          â”‚
â”‚ [ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³è¡¨ç¤º]  â”‚ â† ã‚¿ãƒƒãƒ—ã§ã‚·ãƒ¼ãƒˆè¡¨ç¤º
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

(ã‚·ãƒ¼ãƒˆè¡¨ç¤ºæ™‚)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å•†å“ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ     â”‚ â† èƒŒæ™¯ã«è¦‹ãˆã‚‹
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°    â”‚ â”‚
â”‚ â”‚ (ã‚·ãƒ¼ãƒˆUI)      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç‰¹å¾´:**
- GuidelineSheetä½¿ç”¨ï¼ˆæ—¢å­˜å®Ÿè£…ï¼‰
- ä¸‹ã‹ã‚‰ä¸Šã«ã‚¹ãƒ©ã‚¤ãƒ‰

### ãƒ¢ãƒã‚¤ãƒ« (767pxä»¥ä¸‹)

åŒä¸Šï¼ˆGuidelineSheetä½¿ç”¨ï¼‰

---

## ğŸ¨ å®Ÿè£…ã‚³ãƒ¼ãƒ‰ä¾‹

### GuidelineSidePanel.tsxï¼ˆå®Œå…¨ç‰ˆï¼‰

```typescript
'use client';

import { useState, useEffect } from 'react';
import { X } from 'lucide-react';
import { cn } from '@/lib/utils';
import { Button } from '@/components/ui/button';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { Toggle } from '@/components/ui/toggle';
import { Workflow, ListTree } from 'lucide-react';
import { RatingFlowchart } from './RatingFlowchart';
import { RatingFlowchartDiagram } from './RatingFlowchartDiagram';
import { TagCategoryVisualizer } from './TagCategoryVisualizer';
import { FlowchartMode } from '@/data/guidelines';

interface GuidelineSidePanelProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  initialTab?: 'rating' | 'categories';
  initialRatingFlow?: boolean;
}

export function GuidelineSidePanel({
  open,
  onOpenChange,
  initialTab = 'rating',
  initialRatingFlow = false,
}: GuidelineSidePanelProps) {
  const [activeTab, setActiveTab] = useState(initialTab);
  const [flowchartMode, setFlowchartMode] = useState<FlowchartMode>(
    initialRatingFlow ? 'interactive' : 'diagram'
  );
  const [error, setError] = useState<Error | null>(null);

  // initialTabãŒå¤‰æ›´ã•ã‚ŒãŸã‚‰åæ˜ 
  useEffect(() => {
    setActiveTab(initialTab);
  }, [initialTab]);

  // Escã‚­ãƒ¼ã§é–‰ã˜ã‚‹
  useEffect(() => {
    const handleKeyDown = (e: KeyboardEvent) => {
      if (e.key === 'Escape' && open) {
        onOpenChange(false);
      }
    };

    document.addEventListener('keydown', handleKeyDown);
    return () => document.removeEventListener('keydown', handleKeyDown);
  }, [open, onOpenChange]);

  // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
  if (error) {
    return (
      <aside
        role="complementary"
        aria-label="ã‚¿ã‚°ä»˜ã‘ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³"
        className={cn(
          "fixed left-0 top-0 h-screen w-[clamp(450px,40vw,600px)] z-40",
          "bg-background border-r shadow-lg",
          "flex flex-col items-center justify-center p-6",
          open ? "translate-x-0" : "-translate-x-full"
        )}
      >
        <div className="text-destructive text-center">
          <p className="font-semibold text-lg">ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</p>
          <p className="text-sm mt-2">{error.message}</p>
          <Button onClick={() => window.location.reload()} className="mt-4">
            å†èª­ã¿è¾¼ã¿
          </Button>
        </div>
      </aside>
    );
  }

  return (
    <aside
      role="complementary"
      aria-label="ã‚¿ã‚°ä»˜ã‘ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³"
      aria-hidden={!open}
      className={cn(
        "fixed left-0 top-0 h-screen w-[clamp(450px,40vw,600px)] z-40",
        "bg-background border-r shadow-lg",
        "transition-all duration-250 ease-in-out",
        "flex flex-col",
        open
          ? "translate-x-0 opacity-100"
          : "-translate-x-full opacity-0 pointer-events-none"
      )}
    >
      {/* å›ºå®šãƒ˜ãƒƒãƒ€ãƒ¼ */}
      <div className="flex items-center justify-between px-6 py-4 border-b shrink-0">
        <div>
          <h2 className="text-lg font-semibold">ã‚¿ã‚°ä»˜ã‘ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³</h2>
          <p className="text-sm text-muted-foreground">
            å•†å“ã«é©åˆ‡ãªã‚¿ã‚°ã‚’ä»˜ä¸ã™ã‚‹ãŸã‚ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã§ã™
          </p>
        </div>
        <Button
          variant="ghost"
          size="icon"
          onClick={() => onOpenChange(false)}
          aria-label="ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’é–‰ã˜ã‚‹"
        >
          <X className="h-4 w-4" />
        </Button>
      </div>

      {/* ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */}
      <Tabs
        value={activeTab}
        onValueChange={(value) => setActiveTab(value as 'rating' | 'categories')}
        className="flex-1 flex flex-col min-h-0"
      >
        {/* å›ºå®šã‚¿ãƒ–ãƒªã‚¹ãƒˆ */}
        <TabsList className="grid w-full grid-cols-2 shrink-0 mx-6 mt-4">
          <TabsTrigger value="rating">ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</TabsTrigger>
          <TabsTrigger value="categories">ã‚¿ã‚°ã‚«ãƒ†ã‚´ãƒª</TabsTrigger>
        </TabsList>

        <TabsContent
          value="rating"
          className="flex-1 mt-0 flex flex-col min-h-0 data-[state=inactive]:hidden"
        >
          {/* å›ºå®šãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ */}
          <div className="flex items-center gap-2 px-6 py-3 shrink-0">
            <Toggle
              pressed={flowchartMode === 'interactive'}
              onPressedChange={() => setFlowchartMode('interactive')}
              aria-label="ã‚¹ãƒ†ãƒƒãƒ—å½¢å¼ã«åˆ‡ã‚Šæ›¿ãˆ"
            >
              <Workflow className="mr-2 h-4 w-4" />
              ã‚¹ãƒ†ãƒƒãƒ—å½¢å¼
            </Toggle>
            <Toggle
              pressed={flowchartMode === 'diagram'}
              onPressedChange={() => setFlowchartMode('diagram')}
              aria-label="å›³è¡¨ã§è¦‹ã‚‹"
            >
              <ListTree className="mr-2 h-4 w-4" />
              å›³è¡¨ã§è¦‹ã‚‹
            </Toggle>
          </div>

          {/* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ */}
          <div className="flex-1 overflow-y-auto px-6 pb-4 min-h-0">
            {flowchartMode === 'interactive' ? (
              <RatingFlowchart
                onClose={() => {
                  // ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆå®Œäº†æ™‚ã‚‚ãƒ‘ãƒãƒ«ã¯é–‹ã„ãŸã¾ã¾
                  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰‹å‹•ã§é–‰ã˜ã‚‹
                }}
              />
            ) : (
              <RatingFlowchartDiagram />
            )}
          </div>
        </TabsContent>

        <TabsContent
          value="categories"
          className="flex-1 mt-0 min-h-0 data-[state=inactive]:hidden overflow-y-auto px-6 py-4"
        >
          <TagCategoryVisualizer />
        </TabsContent>
      </Tabs>
    </aside>
  );
}
```

### GuidelineContainer.tsxï¼ˆæ‹¡å¼µç‰ˆï¼‰

```typescript
'use client';

import { useMediaQuery } from '@/hooks/useMediaQuery';
import { GuidelineDialog } from './GuidelineDialog';
import { GuidelineSheet } from './GuidelineSheet';
import { GuidelineSidePanel } from './GuidelineSidePanel';

interface GuidelineContainerProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  initialTab?: 'rating' | 'categories';
  initialRatingFlow?: boolean;
  mode?: 'modal' | 'sidepanel'; // æ–°è¦è¿½åŠ 
}

export function GuidelineContainer({
  mode = 'modal', // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯æ—¢å­˜ã®ãƒ¢ãƒ¼ãƒ€ãƒ«
  ...props
}: GuidelineContainerProps) {
  const isDesktop = useMediaQuery('(min-width: 1024px)');

  // 1024pxæœªæº€ã¯å¸¸ã«ã‚·ãƒ¼ãƒˆ
  if (!isDesktop) {
    return <GuidelineSheet {...props} />;
  }

  // ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã¯modeã«å¿œã˜ã¦åˆ‡ã‚Šæ›¿ãˆ
  return mode === 'sidepanel'
    ? <GuidelineSidePanel {...props} />
    : <GuidelineDialog {...props} />;
}
```

### useGuidelineFirstVisit.tsï¼ˆå®Œå…¨ç‰ˆï¼‰

```typescript
import { useState, useEffect } from 'react';

/**
 * ãƒšãƒ¼ã‚¸ã”ã¨ã®åˆå›è¨ªå•åˆ¤å®šãƒ•ãƒƒã‚¯
 * @param page ãƒšãƒ¼ã‚¸è­˜åˆ¥å­ (ä¾‹: 'register', 'edit')
 * @returns åˆå›è¨ªå•ã‹ã©ã†ã‹
 */
export function useGuidelineFirstVisit(page: string): boolean {
  const [isFirstVisit, setIsFirstVisit] = useState(() => {
    if (typeof window === 'undefined') return false;

    try {
      const key = `guideline-visited-${page}`;
      return !localStorage.getItem(key);
    } catch (error) {
      // LocalStorageç„¡åŠ¹æ™‚ã¯å¸¸ã«åˆå›æ‰±ã„ï¼ˆé–‹ã„ãŸçŠ¶æ…‹ï¼‰
      console.warn('localStorage unavailable:', error);
      return true;
    }
  });

  useEffect(() => {
    if (isFirstVisit && typeof window !== 'undefined') {
      try {
        const key = `guideline-visited-${page}`;
        localStorage.setItem(key, 'true');
      } catch (error) {
        // ã‚¨ãƒ©ãƒ¼ã¯ç„¡è¦–ï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ‰ç­‰ï¼‰
        console.warn('Failed to save visit state:', error);
      }
    }
  }, [isFirstVisit, page]);

  return isFirstVisit;
}
```

### /app/register-item/page.tsxï¼ˆä½¿ç”¨ä¾‹ï¼‰

```typescript
'use client';

import { useState } from 'react';
import { useGuidelineFirstVisit } from '@/hooks/useGuidelineFirstVisit';
import { GuidelineContainer } from '@/components/guidelines/GuidelineContainer';
import { Button } from '@/components/ui/button';

export default function RegisterItemPage() {
  const isFirstVisit = useGuidelineFirstVisit('register');

  // åˆå›è¨ªå•æ™‚ã¯ãƒ‘ãƒãƒ«é–‹ã„ãŸçŠ¶æ…‹ã§å³ãƒã‚¦ãƒ³ãƒˆ
  const [guidelineOpen, setGuidelineOpen] = useState(isFirstVisit);
  const [shouldMount, setShouldMount] = useState(isFirstVisit);
  const [initialTab, setInitialTab] = useState<'rating' | 'categories'>('rating');

  // ãƒ‘ãƒãƒ«ã‚’é–‹ãå‡¦ç†ï¼ˆ2å›ç›®ä»¥é™ã¯ã“ã“ã§åˆã‚ã¦ãƒã‚¦ãƒ³ãƒˆï¼‰
  const handleOpenGuideline = (tab: 'rating' | 'categories') => {
    setShouldMount(true);
    setGuidelineOpen(true);
    setInitialTab(tab);
  };

  return (
    <div className="container mx-auto p-6">
      <h1>å•†å“ç™»éŒ²</h1>

      {/* ãƒ•ã‚©ãƒ¼ãƒ ã‚¨ãƒªã‚¢ */}
      <div className="space-y-6">
        {/* ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ */}
        <div>
          <label>ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</label>
          <select>{/* ... */}</select>
          <Button
            variant="outline"
            size="sm"
            onClick={() => handleOpenGuideline('rating')}
          >
            ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³
          </Button>
        </div>

        {/* ã‚¿ã‚°å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ */}
        <div>
          <label>ã‚¿ã‚°</label>
          <input type="text" />
          <Button
            variant="outline"
            size="sm"
            onClick={() => handleOpenGuideline('categories')}
          >
            ã‚¿ã‚°ã‚«ãƒ†ã‚´ãƒª
          </Button>
        </div>
      </div>

      {/* ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ« - æ¡ä»¶ä»˜ããƒã‚¦ãƒ³ãƒˆ */}
      {shouldMount && (
        <GuidelineContainer
          mode="sidepanel"
          open={guidelineOpen}
          onOpenChange={setGuidelineOpen}
          initialTab={initialTab}
        />
      )}
    </div>
  );
}
```

#### ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯çµ±åˆææ¡ˆ

ç¾åœ¨ã®å®Ÿè£…ã§ã¯3ã¤ã®çŠ¶æ…‹(`guidelineOpen`, `shouldMount`, `initialTab`)ã‚’å€‹åˆ¥ã«ç®¡ç†ã—ã¦ã„ã¾ã™ãŒã€ã“ã‚Œã‚‰ã‚’å˜ä¸€ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ `useGuidelinePanelState` ã«æŠ½å‡ºã™ã‚‹ã“ã¨ã§ã€ã‚³ãƒ¼ãƒ‰ã®ä¿å®ˆæ€§ã¨å†åˆ©ç”¨æ€§ã‚’å‘ä¸Šã§ãã¾ã™ã€‚

```typescript
// hooks/useGuidelinePanelState.ts
export function useGuidelinePanelState(page: string) {
  const isFirstVisit = useGuidelineFirstVisit(page);
  const [guidelineOpen, setGuidelineOpen] = useState(isFirstVisit);
  const [shouldMount, setShouldMount] = useState(isFirstVisit);
  const [initialTab, setInitialTab] = useState<'rating' | 'categories'>('rating');

  const openGuideline = useCallback((tab: 'rating' | 'categories') => {
    setShouldMount(true);
    setGuidelineOpen(true);
    setInitialTab(tab);
  }, []);

  return {
    guidelineOpen,
    setGuidelineOpen,
    shouldMount,
    initialTab,
    openGuideline,
  };
}

// ä½¿ç”¨ä¾‹
export default function RegisterItemPage() {
  const {
    guidelineOpen,
    setGuidelineOpen,
    shouldMount,
    initialTab,
    openGuideline,
  } = useGuidelinePanelState('register');

  return (
    // ... ä¸Šè¨˜ã¨åŒæ§˜
    <Button onClick={() => openGuideline('rating')}>
      ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³
    </Button>
  );
}
```

---

## ğŸš€ å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚º

### ãƒ•ã‚§ãƒ¼ã‚º1: `/register-item` ãƒšãƒ¼ã‚¸ï¼ˆæœ¬ãƒ—ãƒ©ãƒ³ã®ã‚¹ã‚³ãƒ¼ãƒ—ï¼‰

#### ã‚¿ã‚¹ã‚¯1: æ–°è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½œæˆ

1. **GuidelineSidePanel.tsx**
   - ä¸Šè¨˜ã®å®Œå…¨ç‰ˆã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ
   - ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ: å›ºå®šãƒ˜ãƒƒãƒ€ãƒ¼ã€å›ºå®šã‚¿ãƒ–ã€ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
   - ã‚¹ã‚¿ã‚¤ãƒ«: `clamp(450px, 40vw, 600px)` å¹…ã€z-index: 40
   - ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³: 250ms ease-in-out
   - ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰: Escã§é–‰ã˜ã‚‹
   - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º

2. **useGuidelineFirstVisit.ts**
   - ãƒšãƒ¼ã‚¸ã”ã¨ã®ã‚­ãƒ¼ç®¡ç†: `guideline-visited-${page}`
   - LocalStorageã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°: å¸¸ã«åˆå›æ‰±ã„
   - SSRå¯¾å¿œ: `typeof window === 'undefined'` ãƒã‚§ãƒƒã‚¯

#### ã‚¿ã‚¹ã‚¯2: æ—¢å­˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä¿®æ­£

1. **GuidelineContainer.tsx**
   - `mode` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è¿½åŠ ï¼ˆ'modal' | 'sidepanel'ï¼‰
   - ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆå¤‰æ›´: 1024px
   - æ¡ä»¶åˆ†å²: mode='sidepanel' â†’ GuidelineSidePanel

2. **src/app/register-item/page.tsx**
   - `useGuidelineFirstVisit('register')` å°å…¥
   - æ¡ä»¶ä»˜ããƒã‚¦ãƒ³ãƒˆ: åˆå›=å³æ™‚ã€2å›ç›®ä»¥é™=ã‚¯ãƒªãƒƒã‚¯æ™‚
   - åˆæœŸã‚¿ãƒ–å‹•çš„è¨­å®š: ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒœã‚¿ãƒ³â†’'rating'ã€ã‚¿ã‚°ãƒœã‚¿ãƒ³â†’'categories'

#### ã‚¿ã‚¹ã‚¯3: ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°èª¿æ•´

1. **Tailwindã‚¯ãƒ©ã‚¹è¨­å®š**
   - `w-[clamp(450px,40vw,600px)]`
   - `duration-250` ã‚«ã‚¹ã‚¿ãƒ ã‚¯ãƒ©ã‚¹è¿½åŠ ï¼ˆtailwind.config.tsï¼‰

2. **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ç¢ºèª**
   - 1366pxã€1920pxã€2560pxã§ãƒ‘ãƒãƒ«å¹…ç¢ºèª
   - 1024pxå¢ƒç•Œã§ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«â†”ã‚·ãƒ¼ãƒˆåˆ‡ã‚Šæ›¿ãˆç¢ºèª

#### ã‚¿ã‚¹ã‚¯4: ãƒ†ã‚¹ãƒˆ

**ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ:**
- [ ] GuidelineSidePanel: open/closedçŠ¶æ…‹
- [ ] useGuidelineFirstVisit: åˆå›/2å›ç›®åˆ¤å®š
- [ ] GuidelineContainer: modeåˆ‡ã‚Šæ›¿ãˆ

**E2Eãƒ†ã‚¹ãƒˆ:**
- [ ] åˆå›è¨ªå•: ãƒ‘ãƒãƒ«é–‹ã„ãŸçŠ¶æ…‹ã§ãƒã‚¦ãƒ³ãƒˆ
- [ ] 2å›ç›®è¨ªå•: ãƒ‘ãƒãƒ«é–‰ã˜ãŸçŠ¶æ…‹ã€ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§é–‹ã
- [ ] Escã‚­ãƒ¼: ãƒ‘ãƒãƒ«ãŒé–‰ã˜ã‚‹
- [ ] ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ: ã‚³ãƒ³ãƒ†ãƒ³ãƒ„åˆ‡ã‚Šæ›¿ã‚ã‚Š
- [ ] ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆå®Œäº†: ãƒ‘ãƒãƒ«é–‹ã„ãŸã¾ã¾
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–: 1024pxå¢ƒç•Œã§ã‚·ãƒ¼ãƒˆâ†”ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«

**ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯:**
- [ ] ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒªãƒ¼ãƒ€ãƒ¼: role="complementary", aria-label
- [ ] ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰: Tab/Shift+Tabã€Escã§é–‰ã˜ã‚‹
- [ ] ãƒ•ã‚©ãƒ¼ã‚«ã‚¹: ãƒ‘ãƒãƒ«â‡„ãƒ•ã‚©ãƒ¼ãƒ é–“ã‚’è‡ªç”±ã«ç§»å‹•

---

## ğŸ§ª æ¤œè¨¼æ–¹æ³•

### 1. æ©Ÿèƒ½æ¤œè¨¼

```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev

# ãƒ–ãƒ©ã‚¦ã‚¶ã§ç¢ºèª
open http://localhost:3000/register-item
```

**æ¤œè¨¼é …ç›®:**

1. **åˆå›è¨ªå•ã‚·ãƒŠãƒªã‚ª**
   - LocalStorageã‚¯ãƒªã‚¢: `localStorage.clear()`
   - `/register-item` ã«ã‚¢ã‚¯ã‚»ã‚¹
   - âœ… ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«ãŒé–‹ã„ãŸçŠ¶æ…‹ã§è¡¨ç¤ºã•ã‚Œã‚‹
   - âœ… ãƒ‘ãƒãƒ«å¹…ãŒ `clamp(450px, 40vw, 600px)` ã«å¾“ã£ã¦ã„ã‚‹
   - âœ… ãƒ˜ãƒƒãƒ€ãƒ¼ã€ã‚¿ãƒ–ã€ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆãŒå›ºå®š
   - âœ… ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ã®ã¿ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½

2. **2å›ç›®ä»¥é™ã®è¨ªå•ã‚·ãƒŠãƒªã‚ª**
   - ãƒšãƒ¼ã‚¸ãƒªãƒ­ãƒ¼ãƒ‰
   - âœ… ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«ãŒé–‰ã˜ãŸçŠ¶æ…‹
   - âœ… ã€Œãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã€ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ â†’ ãƒ‘ãƒãƒ«é–‹ãã€ratingã‚¿ãƒ–
   - âœ… ã€Œã‚¿ã‚°ã‚«ãƒ†ã‚´ãƒªã€ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ â†’ categoriesã‚¿ãƒ–ã«åˆ‡ã‚Šæ›¿ã‚ã‚‹

3. **æ“ä½œã‚·ãƒŠãƒªã‚ª**
   - âœ… ãƒ‘ãƒãƒ«å†…ã§ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ â†’ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„åˆ‡ã‚Šæ›¿ã‚ã‚Š
   - âœ… ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ â†’ ã‚¹ãƒ†ãƒƒãƒ—å½¢å¼â‡„å›³è¡¨
   - âœ… ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆå®Œäº† â†’ ãƒ‘ãƒãƒ«é–‹ã„ãŸã¾ã¾
   - âœ… Xãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ â†’ ãƒ‘ãƒãƒ«é–‰ã˜ã‚‹
   - âœ… Escã‚­ãƒ¼ â†’ ãƒ‘ãƒãƒ«é–‰ã˜ã‚‹
   - âœ… ãƒ‘ãƒãƒ«å¤–ã‚¯ãƒªãƒƒã‚¯ â†’ é–‰ã˜ãªã„ï¼ˆãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›å¯èƒ½ï¼‰

4. **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–æ¤œè¨¼**
   - âœ… 1920px: ãƒ‘ãƒãƒ«å¹…600pxï¼ˆæœ€å¤§å€¤ï¼‰
   - âœ… 1366px: ãƒ‘ãƒãƒ«å¹…546pxï¼ˆ40vwï¼‰
   - âœ… 1280px: ãƒ‘ãƒãƒ«å¹…512pxï¼ˆ40vwï¼‰
   - âœ… 1124px: ãƒ‘ãƒãƒ«å¹…450pxï¼ˆæœ€å°å€¤ï¼‰
   - âœ… 1023px: ã‚·ãƒ¼ãƒˆè¡¨ç¤ºã«åˆ‡ã‚Šæ›¿ã‚ã‚‹
   - âœ… 767px: ã‚·ãƒ¼ãƒˆè¡¨ç¤º

5. **LocalStorageã‚¨ãƒ©ãƒ¼æ¤œè¨¼**
   - ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ‰ã§ `/register-item` ã«ã‚¢ã‚¯ã‚»ã‚¹
   - âœ… ãƒ‘ãƒãƒ«ãŒé–‹ã„ãŸçŠ¶æ…‹ã§è¡¨ç¤ºã•ã‚Œã‚‹
   - âœ… ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è­¦å‘ŠãŒå‡ºã‚‹ï¼ˆã‚¨ãƒ©ãƒ¼ã§ã¯ãªã„ï¼‰

### 2. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¤œè¨¼

```javascript
// DevTools Console
// åˆå›è¨ªå•æ™‚ã®ãƒã‚¦ãƒ³ãƒˆæ™‚é–“
performance.mark('sidepanel-mount-start');
// ... ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å¾Œ
performance.mark('sidepanel-mount-end');
performance.measure('sidepanel-mount', 'sidepanel-mount-start', 'sidepanel-mount-end');
```

**ç›®æ¨™:**
- åˆå›ãƒã‚¦ãƒ³ãƒˆ: < 100ms
- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³: 250msï¼ˆä»•æ§˜é€šã‚Šï¼‰
- 2å›ç›®ä»¥é™ã®ãƒã‚¦ãƒ³ãƒˆ: < 50ms

#### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™ã®æ ¹æ‹ 

1. **åˆå›ãƒã‚¦ãƒ³ãƒˆ < 100ms**: ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹ã¾ã§ã«å‡¦ç†ãŒå®Œäº†ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€250msã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®åŠåˆ†ä»¥ä¸‹ã‚’ç›®æ¨™ã¨ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒšãƒ¼ã‚¸ã‚’é–‹ã„ãŸç¬é–“ã«ã‚¹ãƒ ãƒ¼ã‚ºãªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒé–‹å§‹ã•ã‚Œã‚‹ã€‚

2. **2å›ç›®ä»¥é™ã®ãƒã‚¦ãƒ³ãƒˆ < 50ms**: ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãªUIã®åŸºæº–ã§ã‚ã‚‹200mså¿œç­”æ€§ç›®æ¨™ï¼ˆ[RAIL model](https://web.dev/rail/)ï¼‰ã®1/4ã‚’ç›®æ¨™ã¨ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã‹ã‚‰å³åº§ã«ãƒ‘ãƒãƒ«ãŒè¡¨ç¤ºã•ã‚Œå§‹ã‚ã‚‹ã€‚

3. **ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ 250ms**: Material Designã®ã‚¬ã‚¤ãƒ€ãƒ³ã‚¹ï¼ˆ[Duration and easing](https://material.io/design/motion/speed.html)ï¼‰ã«åŸºã¥ãã€ä¸­ã‚µã‚¤ã‚ºã®è¦ç´ ã®æ¨™æº–çš„ãªé·ç§»æ™‚é–“ã¨ã—ã¦è¨­å®šã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦–è¦šçš„ãªå¤‰åŒ–ã‚’èªè­˜ã—ã¤ã¤ã€å¾…ã¡æ™‚é–“ã‚’æ„Ÿã˜ãªã„é©åˆ‡ãªãƒãƒ©ãƒ³ã‚¹ã€‚

### 3. ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æ¤œè¨¼

```bash
# axe DevToolsæ‹¡å¼µæ©Ÿèƒ½ã‚’ä½¿ç”¨
# ã¾ãŸã¯
npm run test:a11y
```

**ãƒã‚§ãƒƒã‚¯é …ç›®:**
- [ ] role="complementary" è¨­å®š
- [ ] aria-label, aria-hidden è¨­å®š
- [ ] ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œ: Tab, Shift+Tab, Escape
- [ ] ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒªãƒ¼ãƒ€ãƒ¼: NVDA/JAWSã§èª­ã¿ä¸Šã’ç¢ºèª

---

## ğŸ“ å°†æ¥ã®æ‹¡å¼µï¼ˆãƒ•ã‚§ãƒ¼ã‚º2ä»¥é™ã€æœ¬ãƒ—ãƒ©ãƒ³å¤–ï¼‰

### ãƒ•ã‚§ãƒ¼ã‚º2: å•†å“ç·¨é›†ãƒšãƒ¼ã‚¸

**å‰ææ¡ä»¶:**
- å•†å“è©³ç´°ãƒšãƒ¼ã‚¸ã«ã‚¿ã‚°ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹

**å®Ÿè£…å†…å®¹:**
- ã‚¿ã‚°ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºæ™‚ã« `mode="sidepanel"` ã‚’æŒ‡å®š
- `useGuidelineFirstVisit('edit')` ã§åˆ¥ã‚­ãƒ¼ç®¡ç†

### ãƒ•ã‚§ãƒ¼ã‚º3: è¿½åŠ æ©Ÿèƒ½æ¤œè¨

1. **ãƒ‘ãƒãƒ«å¹…ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º**
   - ãƒ‰ãƒ©ãƒƒã‚°ã§ãƒªã‚µã‚¤ã‚º
   - LocalStorageã§å¹…ã‚’ä¿å­˜

2. **ãƒ”ãƒ³ç•™ã‚æ©Ÿèƒ½**
   - ãƒ‘ãƒãƒ«ã‚’å¸¸ã«é–‹ã„ãŸçŠ¶æ…‹ã«å›ºå®š
   - LocalStorageã§è¨­å®šä¿å­˜

3. **ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ**
   - `Ctrl+/` ã§ãƒ‘ãƒãƒ«ãƒˆã‚°ãƒ«
   - `Ctrl+1` ã§ratingã‚¿ãƒ–ã€`Ctrl+2` ã§categoriesã‚¿ãƒ–

---

## âœ… å®Œäº†æ¡ä»¶

### ãƒ•ã‚§ãƒ¼ã‚º1å®Œäº†ã®å®šç¾©

- [ ] `GuidelineSidePanel.tsx` ä½œæˆå®Œäº†
- [ ] `useGuidelineFirstVisit.ts` ä½œæˆå®Œäº†
- [ ] `GuidelineContainer.tsx` æ‹¡å¼µå®Œäº†
- [ ] `/register-item` ã§ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«ãŒæ­£å¸¸ã«å‹•ä½œ
- [ ] ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—(1024pxä»¥ä¸Š)ã§ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«è¡¨ç¤º
- [ ] ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ/ãƒ¢ãƒã‚¤ãƒ«(1023pxä»¥ä¸‹)ã§ã‚·ãƒ¼ãƒˆè¡¨ç¤º
- [ ] åˆå›è¨ªå•æ™‚ã®ã¿ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«ãŒé–‹ã„ãŸçŠ¶æ…‹
- [ ] 2å›ç›®ä»¥é™ã¯ã‚¯ãƒªãƒƒã‚¯æ™‚ã«é…å»¶ãƒã‚¦ãƒ³ãƒˆ
- [ ] ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ãŒé€šé
- [ ] ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯å®Œäº†
- [ ] ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Œäº†

---

## ğŸ“š é‡è¦ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

### æ–°è¦ä½œæˆ

- `src/components/guidelines/GuidelineSidePanel.tsx`
- `src/hooks/useGuidelineFirstVisit.ts`

### ä¿®æ­£

- `src/components/guidelines/GuidelineContainer.tsx`
- `src/app/register-item/page.tsx` ã¾ãŸã¯é–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### å‚ç…§ï¼ˆæ—¢å­˜ï¼‰

- `src/components/guidelines/GuidelineDialog.tsx`
- `src/components/guidelines/GuidelineSheet.tsx`
- `src/components/guidelines/RatingFlowchart.tsx`
- `src/components/guidelines/RatingFlowchartDiagram.tsx`
- `src/components/guidelines/TagCategoryVisualizer.tsx`
- `src/data/guidelines/types.ts`

---

**ä½œæˆæ—¥**: 2026-01-08
**æœ€çµ‚æ›´æ–°**: 2026-01-08
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… ä»•æ§˜ç¢ºå®šæ¸ˆã¿ - å®Ÿè£…æº–å‚™å®Œäº†
**è¦‹ç©ã‚‚ã‚Šå·¥æ•°**: 4-6æ™‚é–“ï¼ˆã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°3-4hã€ãƒ†ã‚¹ãƒˆ1-2hï¼‰
